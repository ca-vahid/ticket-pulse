export const APP_VERSION = '1.2.0-preview';

export const changelog = [
  {
    version: '1.2.0-preview',
    date: 'February 25, 2026',
    entries: [
      { type: 'new', text: 'Coverage Analysis tab on technician detail — shows overnight eligible tickets (previous business day 5 PM PT → 9 AM PT) split into "Picked by tech" vs "Not Picked" with full ticket lists' },
      { type: 'new', text: 'Merged Timeline modal — chronological view of all overnight + daytime tickets with picked (green) vs not-picked (grey/dimmed) visual coding, filterable in real time' },
      { type: 'new', text: 'Timeline markers — "Agent Start", "Vancouver Online (9 AM PT)", and "Agent End" separator lines inserted at correct chronological positions in the merged timeline' },
      { type: 'new', text: 'Extended timeline to 5 PM PT — merged view now shows tickets arriving after 9 AM through end of business day, separated by the HQ-online marker' },
      { type: 'new', text: 'Overnight vs early-morning ticket indicators — moon icon for tickets arriving before 5 AM ET, sunrise icon for 5 AM ET and later, with subtle background tinting' },
      { type: 'new', text: 'Exclude filters on "Not Picked" — keyword search and clickable category pills to hide irrelevant overnight tickets; click any category badge on a ticket row to instantly exclude that category' },
      { type: 'new', text: 'Prev/Next navigation inside merged timeline modal — arrow buttons to step through days or weeks without closing the modal' },
      { type: 'new', text: 'Wait-time metric on coverage tickets — purple badge showing how long each ticket sat before first assignment (e.g., "⏱ 2h15m")' },
      { type: 'new', text: 'Per-technician work schedules — new Settings page section to configure each tech\'s start time, end time, and timezone with one-click segmented controls' },
      { type: 'new', text: 'PATCH /api/visuals/agents/:id/schedule endpoint — save per-tech work hours and timezone independently of FreshService sync' },
      { type: 'new', text: 'FreshService timezone normalization — human-readable timezone strings (e.g., "Pacific Time (US & Canada)") automatically mapped to IANA identifiers on sync and in the UI' },
      { type: 'new', text: 'Coverage analysis backend service — avoidanceAnalysisService.js computes overnight eligible/picked/not-picked ticket lists per tech with extended-day ticket loading' },
      { type: 'improved', text: 'Coverage analysis scoped to Eastern/Atlantic technicians only — HQ (Pacific) techs see a clear "not applicable" message instead of empty data' },
      { type: 'improved', text: 'Tech sync no longer overwrites manually-set timezones — upsert preserves timezone, location, showOnMap, and isMapManager fields' },
      { type: 'improved', text: 'Two-column side-by-side layout for picked vs not-picked tickets with both columns flush at the top' },
      { type: 'improved', text: 'Ticket rows are single-line compact — ticket number removed (link icon retained), subject truncates, all metadata on one row' },
      { type: 'improved', text: 'Agents endpoint now supports includeInactive query parameter for the schedules settings page' },
      { type: 'fixed', text: 'Removed old avoidance badge/scoring system (Flagged/Watch/Good) from dashboard cards and settings — replaced by transparent ticket-list approach' },
      { type: 'database', text: 'New columns: technicians.work_start_time (VARCHAR 5) and technicians.work_end_time (VARCHAR 5) — nullable, migration included, uses IF NOT EXISTS for safe re-run' },
    ],
  },
  {
    version: '1.1.2-preview',
    date: 'February 23, 2026',
    entries: [
      { type: 'new', text: 'Expandable ticket drilldown in compact view — click the chevron on any technician row to see all tickets for the period, with self-picked tickets highlighted and closed tickets shown in a muted style' },
      { type: 'new', text: 'Ticket drilldown works in daily, weekly, and monthly compact views — sections automatically label as "Today\'s tickets", "This week\'s tickets", or "This month\'s tickets"' },
      { type: 'new', text: 'Closed/Resolved section in drilldown — tickets that were closed appear in both the main list and a dedicated greyed-out section below a divider' },
      { type: 'new', text: 'Expand All / Collapse All button — appears in compact view header to toggle all technician drilldowns at once' },
      { type: 'new', text: 'Centralized ExpandableTicketList component — single source of truth for ticket row rendering, grouping, and styling across all views' },
      { type: 'new', text: 'Automatic session recovery on 401 — expired sessions silently re-authenticate via Azure AD token exchange instead of showing a dead "Authentication required" screen' },
      { type: 'improved', text: 'SSE reconnection with exponential backoff — connection status stays "Connecting..." during retries instead of falsely showing "Offline" on first load' },
      { type: 'improved', text: 'Ticket drilldown rows show full requester name and email in brackets (previously only showed first name)' },
      { type: 'improved', text: 'Ticket drilldown sorted by arrival time (newest first) with date shown in weekly/monthly views (e.g., "Mon, 2/23 11:42 AM")' },
      { type: 'improved', text: 'Error retry button on dashboard now retries loading the current view instead of triggering a full FreshService sync' },
      { type: 'fixed', text: 'Weekly ticket counts showing 0 on current week — weeklyTickets filter now uses timezone-aware boundaries (America/Los_Angeles) consistent with daily breakdown calculations' },
      { type: 'fixed', text: 'SSE connection getting stuck on "Offline" after auth/network hiccup — EventSource now auto-recreates with backoff instead of staying closed' },
      { type: 'fixed', text: '"Authentication required" screen with broken Retry button — 401 errors now trigger silent token re-exchange or redirect to login' },
    ],
  },
  {
    version: '1.1.0-preview',
    date: 'February 22, 2026',
    entries: [
      { type: 'new', text: 'Technician detail Overview tab — period performance summary with metrics, daily breakdown, self-pick rate, assigners, and category breakdown' },
      { type: 'new', text: 'Daily/Weekly toggle on technician detail page — switch views without navigating back to the dashboard' },
      { type: 'new', text: 'Clickable day boxes in weekly view — click a day on any technician\'s weekly breakdown to jump directly to that tech\'s daily detail' },
      { type: 'new', text: 'Clickable mini-calendar in weekly mode — click any day in the top calendar bar to switch to that day\'s daily view' },
      { type: 'new', text: 'Day-of-month numbers shown on weekly calendars — both the dashboard mini-calendar and per-technician weekly breakdown now display date numbers (e.g., Mon 19, Tue 20)' },
      { type: 'new', text: 'Backend read cache middleware — server-side response caching (10-15s TTL) on all dashboard endpoints, cleared automatically on sync' },
      { type: 'new', text: 'Frontend data cache with stale-while-revalidate, request deduplication, and LRU eviction' },
      { type: 'new', text: 'Hover prefetch on technician cards — data is preloaded when hovering over a technician card for faster navigation' },
      { type: 'improved', text: 'Loading overlay now appears when switching dates in daily mode (previously only showed for weekly/monthly switches)' },
      { type: 'improved', text: 'Weekly summary metrics redesigned — Total and Closed counts are now visually highlighted with bold filled cards; other metrics use a simplified neutral palette' },
      { type: 'improved', text: 'Day box hover animation — individual day boxes in weekly breakdown scale up with a blue ring on hover for clear click affordance' },
      { type: 'improved', text: 'Back navigation preserves origin view — clicking a day in weekly view and pressing Back correctly returns to weekly dashboard, not daily' },
      { type: 'fixed', text: 'SSE connection shows "Connecting..." instead of false "Offline" during initial page load — added three-state connection status (connecting/connected/disconnected)' },
      { type: 'fixed', text: 'Technician detail crash on navigation — added null guard in getInitials() and race-safe fetch with sequence tracking' },
      { type: 'fixed', text: 'Weekly technician detail showing 0s on first load — bypassed frontend cache for weekly detail fetch to avoid stale data from cache dedup race condition' },
      { type: 'fixed', text: 'Week range display stuck on "Loading..." — falls back to local selectedWeek state when API weekStart field is missing' },
    ],
  },
  {
    version: '1.0.0',
    date: 'February 18, 2026',
    entries: [
      { type: 'new', text: 'Real-time IT helpdesk dashboard with SSE live updates' },
      { type: 'new', text: 'Daily, weekly, and monthly ticket views with calendar navigation' },
      { type: 'new', text: 'Self-picked vs assigned ticket detection algorithm' },
      { type: 'new', text: 'Smart search with OR/AND operators and category filtering' },
      { type: 'new', text: 'Azure AD SSO authentication replacing password login' },
      { type: 'new', text: 'Azure deployment with App Service, Static Web Apps, and PostgreSQL' },
      { type: 'new', text: 'GitHub Actions CI/CD for automated backend and frontend deployments' },
      { type: 'new', text: 'Profile photo sync from Azure AD (Entra ID)' },
      { type: 'new', text: 'CSAT score tracking with feedback display' },
      { type: 'new', text: 'Technician map visualization page' },
      { type: 'new', text: 'Excel/XLSX ticket export with formatting' },
      { type: 'new', text: 'LLM-powered auto-response configuration panel' },
      { type: 'improved', text: 'Activity analysis progress logging every 50 tickets during sync' },
      { type: 'improved', text: 'Compact and grid view modes for technician cards' },
      { type: 'fixed', text: 'Timezone bug causing tomorrow\'s tickets to appear in Pacific evening' },
      { type: 'fixed', text: 'SPA routing 404 on page refresh with staticwebapp.config.json' },
      { type: 'fixed', text: 'Cross-origin session cookies for Static Web App to App Service' },
      { type: 'fixed', text: 'Database schema drift resolved with catch-all migration' },
      { type: 'fixed', text: 'Photo sync using incorrect API base URL on production' },
    ],
  },
];
